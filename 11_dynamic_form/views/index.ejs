<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <title>Document</title>
    <style>
        div.result {
            padding: 20px;
            border-top: 2px solid #ccc;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <h1>동적폼 전송하기</h1>
    <form name="register">
        <label for="name">이름</label>
        <input type="text" name="name2" id="name">
        <br>
        <label>성별: </label>

        <label for="male">남</label>
        <input type="radio" name="gender" id="male" value="male" >

        <label for="female">여</label>
        <input type="radio" name="gender" id="female" value="female">
        <!-- 남여 둘 중에 하나말 골라야하기 때문에 name=gender  공통으로 주고 
            label에 있는 for 과 input에 있는 id 값이 똑같아야 radio가 선택된다. -->

        <br><br>
        <button type="button" onclick="ajaxGet()">Ajax get 제출하기</button>
        <button type="button" onclick="ajaxPost()">Ajax post 제출하기</button>
        <br><br>
        <hr/>
        <button type="button" onclick="axiosGet()">Axios Get 제출하기</button>
        <button type="button" onclick="axiosPost()">Axios Post 제출하기</button>
        <br><br>
        <hr/>
        <button type="button" onclick="fetchGet()">Fetch Get 제출하기</button>
        <button type="button" onclick="fetchPost()">Fetch Post 제출하기</button>





        <!-- 전송한 결과를 보여주는 곳 -->
        <div class="result"></div>
    </form>
    <script>
        const resultBox = document.querySelector('.result');

        function ajaxGet() {
            const form = document.forms['register'];
            const data = {
                name: form.name.value,
                gender: form.gender.value
            }
            $.ajax({
                type: 'get',
                url: '/ajax',
                data: data,
                success: function (data) {
                    console.log('ajax get-->', data);
                    resultBox.textContent = `GET/Ajax 요청완료! ${data.name} 님의 성별은 ${data.gender}입니다.`;
                }
            })


            // let userName= form.name2.value;
            //resultBox.textContent= `${userName}입니다.  `

            // console.log(form.gender.value)
            // console.log(form.name2.value)


            // resultBox.innerText='연습입니다.'
            // resultBox.textContent='연습입니다.'
            //둘다 같은 결과물이 나온다. 

        }

        ///------------------------------------
        function ajaxPost() {
            const form = document.forms['register'];
            const data = {
                name: form.name.value,
                gender: form.gender.value
            }
            $.ajax({
                type: 'post',
                url: '/ajax',
                data: data,
                success: function (data) {
                    console.log('ajax post-->', data);
                    resultBox.textContent = `POST/Ajax 요청완료! ${data.name} 님의 성별은 ${data.gender}입니다.`;
                }

            })
        }
        // 2.axios------------------------------------
        function axiosGet(){
            const form = document.forms['register'];
            const data = {
                name: form.name.value,
                gender: form.gender.value
            }
            axios({
                method:'get',
                url:'/axios',
                params:data
            }).then((response)=>{
                console.log(response.data);
                resultBox.textContent=`GET/Axios 요청완료! ${data.name} 님의 성별은 ${data.gender}입니다.`;

            }).catch((err)=>{
                console.log("ERROR")
             resultBox.textContent=`GET/Axios 요청실패 ${err.response.data}`
            })
        }


        function axiosPost(){
            const form = document.forms['register'];
            const data = {
                name: form.name.value,
                gender: form.gender.value
            }
            axios({
                method:'post',
                url:'/axios',
                data:data
            }).then((response)=>{
                console.log("response.data: " , response.data);
                resultBox.textContent=`POST/Axios 요청완료! ${data.name} 님의 성별은 ${data.gender}입니다.`;

            }).catch((err)=>{
                console.log("ERROR")
             resultBox.textContent=`POST/Axios 요청실패 ${err.response.data}`
            })
        }
        // 3.fetch------------------------------------javascript내장 함수 
        function fetchGet(){
            const form = document.forms['register'];
            const data = {
                name: form.name.value,
                gender: form.gender.value
            }
            fetch(`/fetch?name=${data.name}&gender=${data.gender}`, {method:"GET"})
            .then((response)=>{
                return response.json()
            })
            .then((data)=>{
                console.log('DATA: ', data);
                resultBox.textContent=`GET/Fetch 요청완료! ${data.name} 님의 성별은 ${data.gender}입니다.`;
            })
        }
        function fetchPost(){
            const form = document.forms['register'];
            const data = {
                name: form.name.value,
                gender: form.gender.value
            }
            fetch("/fetch", {
                method:'post',
                headers:{"Content-Type":"application/json"},
                body:JSON.stringify(data)
            })
            .then((response)=>{
                return response.json()
            })
            .then((data)=>{
                console.log('DATA: ', data);
                resultBox.textContent=`POST/Fetch 요청완료! ${data.name} 님의 성별은 ${data.gender}입니다.`;
            }).catch((err)=>{
                console.log('ERROR: ' , err.message)
            })
        }
    </script>


</body>

</html>